# NOTE: Le plugin @netlify/plugin-lighthouse doit être désactivé dans l'UI Netlify
# car il n'est pas compatible avec Node 20+
# Allez sur : Site Settings → Plugins → Lighthouse → Remove

[build]
  publish = "dist"
  command = "pnpm build:tina"

[build.environment]
  NODE_VERSION = "20"
  NETLIFY_USE_PNPM = "true"
  # Optimisations Node.js pour réduire l'utilisation mémoire et accélérer le build
  NODE_OPTIONS = "--max-old-space-size=4096"
  # Désactiver les telemetry pour accélérer le build
  ASTRO_TELEMETRY_DISABLED = "1"

[functions]
  directory = './src/functions'

[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
